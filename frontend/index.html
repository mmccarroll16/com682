<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>LocalBites Media</title>
  <link rel="stylesheet" href="style.css" />

  <!-- ✅ Azure Application Insights (SAFE snippet - won't break site if blocked) -->
  <script>
    // Stub so calls never crash if the script is blocked
    window.appInsights = window.appInsights || {
      trackEvent: function () {},
      trackException: function () {},
      trackPageView: function () {},
      trackMetric: function () {}
    };

    (function () {
      var cs =
        "InstrumentationKey=8de29fe0-4fec-45a3-975a-201749fdfc85;IngestionEndpoint=https://italynorth-0.in.applicationinsights.azure.com/;LiveEndpoint=https://italynorth.livediagnostics.monitor.azure.com/;ApplicationId=6e26f38b-1136-4ace-96b9-6085118c994f";

      var s = document.createElement("script");
      s.src = "https://js.monitor.azure.com/scripts/b/ai.2.min.js";
      s.async = true;

      s.onload = function () {
        try {
          var inst = new Microsoft.ApplicationInsights.ApplicationInsights({
            config: {
              connectionString: cs,
              enableAutoRouteTracking: true
            }
          });
          inst.loadAppInsights();
          window.appInsights = inst; // replace stub with real instance
          window.appInsights.trackPageView();
        } catch (e) {
          console.warn("App Insights init failed:", e);
        }
      };

      s.onerror = function () {
        console.warn("App Insights script blocked/failed to load.");
      };

      document.head.appendChild(s);
    })();
  </script>
</head>

<body>
  <h1>LocalBites Upload & Reviews</h1>

  <section class="card">
    <h2>Create restaurant (CRUD)</h2>
    <form id="createRestaurantForm">
      <label for="newName">Restaurant Name</label>
      <input id="newName" required />

      <label for="newAddress">Address</label>
      <input id="newAddress" required />

      <label for="newCity">City</label>
      <input id="newCity" required />

      <button type="submit">Create</button>
      <p id="createStatus" class="small"></p>
    </form>
  </section>

  <section class="card">
    <h2>Upload review + image</h2>

    <form id="uploadForm">
      <label for="restaurantId">Restaurant ID</label>
      <input id="restaurantId" required />

      <label for="userID">User ID</label>
      <input id="userID" required />

      <label for="userName">User Name</label>
      <input id="userName" required />

      <label for="rating">Rating (1-5)</label>
      <input id="rating" type="number" min="1" max="5" required />

      <label for="comment">Comment</label>
      <input id="comment" required />

      <label for="file">Choose Image</label>
      <input id="file" type="file" accept="image/*" required />

      <button type="submit">Upload</button>
      <!-- ✅ small tweak: keep upload status separate from restaurant load status -->
      <p id="uploadStatus" class="small"></p>
    </form>
  </section>

  <section class="card">
    <h2>Restaurants</h2>
    <button id="refreshBtn" type="button">Load all</button>
    <p id="loadStatus" class="small"></p>
    <div id="gallery" class="gallery"></div>
  </section>

  <script src="app.js"></script>
</body>
</html>
